CREATE GENERATOR GEN_SALIDA;

CREATE TABLE SALIDA (
    ID                     INTEGER NOT NULL,
    ID_ELEMENTO            INTEGER NOT NULL,
    FECHA_SALIDA           DATE NOT NULL,
    OBSERVACIONES_SALIDA   BLOB SUB_TYPE 1 SEGMENT SIZE 8192,
    FECHA_REGRESO          DATE,
    OBSERVACIONES_REGRESO  BLOB SUB_TYPE 1 SEGMENT SIZE 8192,
    FECHA                  TIMESTAMP DEFAULT current_timestamp,
    USUARIO                VARCHAR(15) DEFAULT current_user
);

ALTER TABLE SALIDA ADD CONSTRAINT PK_SALIDA PRIMARY KEY (ID);

CREATE INDEX SALIDA_IDX1 ON SALIDA (ID_ELEMENTO);
CREATE INDEX SALIDA_IDX2 ON SALIDA (FECHA_SALIDA);

SET TERM ^ ;

CREATE OR ALTER TRIGGER SALIDA_BI FOR SALIDA
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if (new.id is null or new.id = -1) then
    new.id = gen_id(gen_salida,1);
end
^

SET TERM ; ^

